<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TVTOTO ULTRA | Enterprise Monitoring</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap');
        :root { --bg: #020617; --accent: #6366f1; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: #f8fafc; height: 100vh; overflow: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.05); }
        .table-scroll { height: calc(100vh - 280px); overflow-y: auto; }
        .table-scroll::-webkit-scrollbar { width: 4px; }
        .table-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .status-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } }
        .row-update { animation: flash 1.5s ease-out; }
        @keyframes flash { from { background: rgba(99, 102, 241, 0.2); } to { background: transparent; } }
        .active-glow { box-shadow: 0 0 15px rgba(16, 185, 129, 0.2); border-left: 3px solid #10b981 !important; }
    </style>
</head>
<body class="p-4 md:p-6">

    <div class="max-w-[1800px] mx-auto flex flex-col gap-6 h-full">
        <header class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                <div class="w-14 h-14 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-xl shadow-indigo-500/20">
                    <i class="fas fa-shield-halved text-white text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black tracking-tighter italic">TVTOTO <span class="text-indigo-500 underline decoration-indigo-500/30">ULTRA</span></h1>
                    <div class="flex items-center gap-2">
                        <span id="syncStatus" class="flex items-center gap-1.5 text-[10px] font-black text-emerald-500 uppercase tracking-[0.2em]">
                            <span class="w-2 h-2 bg-emerald-500 rounded-full status-pulse"></span> Security Protocol Active
                        </span>
                    </div>
                </div>
            </div>

            <div class="flex flex-wrap justify-center gap-4">
                <div class="glass px-6 py-3 rounded-2xl border-b-4 border-indigo-500 min-w-[200px]">
                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Total Global Balance</p>
                    <h2 id="totalAll" class="text-2xl font-black mono text-white">Rp 0</h2>
                </div>
                <div class="glass px-6 py-3 rounded-2xl border-b-4 border-emerald-500 min-w-[140px]">
                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Active / Total</p>
                    <h2 id="nodeStats" class="text-2xl font-black mono text-white">0 / 0</h2>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-12 gap-6 overflow-hidden flex-1">
            <div class="col-span-12 lg:col-span-3 flex flex-col gap-6 overflow-hidden">
                <div class="glass rounded-3xl p-6">
                    <h3 class="text-xs font-black text-slate-400 uppercase mb-4 tracking-widest flex items-center gap-2">
                        <i class="fas fa-chart-pie text-indigo-500"></i> Distribution
                    </h3>
                    <div id="bankStats" class="space-y-4 max-h-[250px] overflow-y-auto pr-2"></div>
                </div>
                
                <div class="glass rounded-3xl p-6 flex-1 overflow-hidden flex flex-col">
                    <h3 class="text-xs font-black text-slate-400 uppercase mb-4 tracking-widest flex items-center justify-between">
                        <span>Terminal Logs</span>
                        <span class="text-[9px] bg-white/5 px-2 py-0.5 rounded">REALTIME</span>
                    </h3>
                    <div id="logs" class="text-[11px] mono text-slate-400 space-y-3 overflow-y-auto scrollbar-hide"></div>
                </div>
            </div>

            <div class="col-span-12 lg:col-span-9 glass rounded-[2.5rem] flex flex-col overflow-hidden border border-white/5 relative">
                <div class="p-6 bg-white/[0.02] border-b border-white/5 flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="relative w-full md:w-96">
                        <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-500"></i>
                        <input type="text" id="search" onkeyup="filter()" placeholder="Search Identity or Account..." class="w-full bg-slate-950/50 border border-white/10 rounded-2xl py-3 pl-12 pr-4 text-sm focus:border-indigo-500 transition-all outline-none focus:ring-4 focus:ring-indigo-500/10">
                    </div>
                    <div class="flex gap-2 w-full md:w-auto">
                        <button onclick="syncData()" class="flex-1 md:flex-none bg-indigo-600 hover:bg-indigo-500 px-6 py-3 rounded-2xl text-xs font-black tracking-widest transition-all flex items-center justify-center gap-2 shadow-lg shadow-indigo-600/20">
                            <i class="fas fa-rotate"></i> SYNC ENGINE
                        </button>
                    </div>
                </div>

                <div class="table-scroll">
                    <table class="w-full text-left border-collapse">
                        <thead class="sticky top-0 bg-slate-900/95 backdrop-blur-md z-10">
                            <tr class="text-[10px] font-black text-slate-500 uppercase tracking-widest border-b border-white/5">
                                <th class="p-6">Network Unit</th>
                                <th class="p-6">Account Identity</th>
                                <th class="p-6 text-right">Current Balance</th>
                                <th class="p-6 text-center">Status</th>
                            </tr>
                        </thead>
                        <tbody id="mainTable" class="divide-y divide-white/[0.02]">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSsnosH5qmA4ADdf2nPeM7k1JdZI-RDhgA4Y8GgSmB5Qs-9MCaaEdeykDzRGFjjcrjhotKKSyd5J_D0/pub?gid=1655913458&single=true&output=csv';
        
        let masterNodes = [
            { bank: "OCBC", norek: "621810071939", nama: "Raisah Bt Rali" },
            { bank: "OCBC", norek: "624810073756", nama: "Jerry Rand" },
            { bank: "SINARMAS", norek: "59567365", nama: "Raisah Bt Rali" },
            { bank: "SINAR MAS", norek: "18464268", nama: "TUTI SAHRIYATUN" },
            { bank: "SINARMAS", norek: "59632086", nama: "Asha Intan Permatasari" },
            { bank: "DANAMON", norek: "3690919737", nama: "Hendra" },
            { bank: "DANAMON", norek: "903691375012", nama: "UMAS" },
            { bank: "DANAMON", norek: "3692115276", nama: "HANI SITI WAHYUNI" },
            { bank: "BCA", norek: "1940533356", nama: "Billy Tanjung Kurniawan" },
            { bank: "BCA", norek: "5781176851", nama: "Idris Sardi" },
            { bank: "BCA", norek: "663529428", nama: "Adellia Citra" },
            { bank: "BCA", norek: "7120806232", nama: "Rahman Fauzan Oktora" },
            { bank: "BNI", norek: "1926659556", nama: "Ujang Suparman" },
            { bank: "BNI", norek: "1821381905", nama: "ALVIN NUARI" },
            { bank: "BNI", norek: "1984533769", nama: "Irma Yunita" },
            { bank: "MANDIRI", norek: "1060020111673", nama: "Fandy Ramadhan" },
            { bank: "MANDIRI", norek: "1150010841072", nama: "Muhamad Ramdhan Saputra" },
            { bank: "MANDIRI", norek: "1150010841973", nama: "Wahidin" },
            { bank: "MANDIRI", norek: "1630011517151", nama: "M. Encep Juliana" },
            { bank: "MANDIRI", norek: "1050021291152", nama: "Abdul Akbar" },
            { bank: "MANDIRI", norek: "1560025221336", nama: "Dede" },
            { bank: "MANDIRI", norek: "1190012025357", nama: "FATHAN FARISAN" },
            { bank: "MANDIRI", norek: "1110024376150", nama: "Irwan firmansyah" },
            { bank: "MANDIRI", norek: "1110024362895", nama: "Yoniko Samura Narazhaki" },
            { bank: "MANDIRI", norek: "1150010412486", nama: "Nurlindawati" },
            { bank: "BRI", norek: "224801006440509", nama: "Susanto" },
            { bank: "BRI", norek: "370501002173501", nama: "Faizah" },
            { bank: "BRI", norek: "384801022008500", nama: "Vito Radiansah" },
            { bank: "BCA", norek: "7125821189", nama: "Ahmad rifaldi" },
            { bank: "BCA", norek: "842477920", nama: "BENTAR PUTRA PRATAMA" },
            { bank: "BRI", norek: "041801022619503", nama: "Ferdi alexander" },
            { bank: "BCA", norek: "4931010845", nama: "Heni Parantina" },
            { bank: "BCA", norek: "0955074161", nama: "Lia Kusmiati" },
            { bank: "BCA", norek: "4931010870", nama: "Sanah" },
            { bank: "BCA", norek: "4080275736", nama: "EKA SUSANTI" },
            { bank: "DANAMON", norek: "903687401202", nama: "Kezia Victoria Halim" },
            { bank: "DANAMON", norek: "3682785617", nama: "Marchellino Alfaro" },
            { bank: "BCA", norek: "2770799271", nama: "WD BARU BCA G1 / HANIKA" },
            { bank: "BCA", norek: "4770265431", nama: "WD BARU BCA G2 / RACHEL INEKE PUTRI" },
            { bank: "BCA", norek: "7275566039", nama: "WD BARU BCA G3 / SITI HEFTIYANAH" },
            { bank: "BCA", norek: "3120967893", nama: "WD BARU BCA G4 / Inzaghi" },
            { bank: "BCA", norek: "0322713337", nama: "WD BARU BCA G5 / Gusnimar" },
            { bank: "BCA", norek: "6313017261", nama: "WD BARU BCA G7 / MUHAMMAD ABIZAL" },
            { bank: "BCA", norek: "2320743829", nama: "WD BARU BCA G8 / SURYA DITA RAHMATUL AKBAR" },
            { bank: "BCA", norek: "2620246002", nama: "WD BARU BCA G10 / TERRA INGGIT HERMAWAN" },
            { bank: "BCA", norek: "5320274798", nama: "WD BARU BCA G12 / ENTIK SUPARMAN" },
            { bank: "BCA", norek: "5860564442", nama: "WD BARU BCA G13 / MUHAMAD RIZKY" },
            { bank: "BCA", norek: "0031438801", nama: "WD BARU BCA G14 / KHESYA ALEYA PUTRI" },
            { bank: "BCA", norek: "3110139623", nama: "WD BARU BCA G15 / M. DANI ABDUL MANAP" },
            { bank: "BCA", norek: "0010824427", nama: "WD BARU BCA G16 / ROBBY KUSUMA" },
            { bank: "BCA", norek: "0740187309", nama: "WD BARU BCA G17 / RIZKI APRIADI" },
            { bank: "BCA", norek: "7680835416", nama: "WD BARU BCA G18 / MARTHEN JEVERSON DJAWE MONE" },
            { bank: "BCA", norek: "1790386759", nama: "WD BARU BCA G20 / Suhaeriah" },
            { bank: "BCA", norek: "1790387275", nama: "WD BARU BCA G21 / Iwan" },
            { bank: "BCA", norek: "2290700895", nama: "WD BARU BCA G22 / AHMAD SYAUKI" },
            { bank: "BCA", norek: "4670456922", nama: "WD BARU BCA G23 / RAFLY FADILLAH" },
            { bank: "BCA", norek: "2453648117", nama: "WD BARU BCA G24 / WIKA ISMAWATII" },
            { bank: "BCA", norek: "0020325941", nama: "WD BARU BCA G25 / GUSTIAN" },
            { bank: "BCA", norek: "5781171892", nama: "WD BARU BCA G26 / APRILIANTO" },
            { bank: "BCA", norek: "6087026304", nama: "WD BARU BCA G27 / Saeful Anwar" },
            { bank: "BCA", norek: "4871057936", nama: "WD BARU BCA G28 / Irham Permana Solehudin" },
            { bank: "BCA", norek: "4120398186", nama: "WD BARU BCA G29 / HAMDAN" },
            { bank: "BCA", norek: "7655625119", nama: "WD BARU BCA G30 / IRWAN KURNIAWAN" },
            { bank: "BCA", norek: "4120398526", nama: "WD BARU BCA G31 / ARVAN AVANDI" },
            { bank: "BCA", norek: "5411607802", nama: "WD BARU BCA G32 / Muhaddad" },
            { bank: "BCA", norek: "4871055585", nama: "WD BARU BCA G33 / Muhammad Noerchalik" },
            { bank: "BCA", norek: "1610170869", nama: "WD BARU BCA G34 / Muhammad Khairul Ummam" },
            { bank: "BCA", norek: "7030454558", nama: "WD BARU BCA G36 / SUGENG WIDODO" },
            { bank: "BCA", norek: "6920300063", nama: "WD BARU BCA G37 / MISDA" },
            { bank: "BCA", norek: "2453647561", nama: "WD BARU BCA G38 / ROHILAH" },
            { bank: "BCA", norek: "4810368697", nama: "WD BARU BCA G39 / DAVIEN JOE WIJAYA" },
            { bank: "BCA", norek: "5411606288", nama: "WD BARU BCA G40 / NURHADI" },
            { bank: "BCA", norek: "5195214333", nama: "WD BARU BCA G41 / EFI REFLINI" },
            { bank: "BCA", norek: "8011098258", nama: "WD BARU BCA G42 / RANI SYAFRINA" },
            { bank: "BCA", norek: "6920300209", nama: "WD BARU BCA G43 / NURASIAH" },
            { bank: "BCA", norek: "5885270244", nama: "WD BARU BCA G44 / DEVIN FERNANDO" },
            { bank: "BCA", norek: "2530408348", nama: "WD BARU BCA G45 / AHMAD ALTHOF" },
            { bank: "BCA", norek: "0690669722", nama: "WD BARU BCA G46/ Mafiyah" },
            { bank: "BCA", norek: "0562522768", nama: "WD BARU BCA G47/ ALVIN SULHAN HADI" },
            { bank: "BCA", norek: "6085042339", nama: "WD BARU BCA G48 / AKHMAD GHIFARI AKBAR" },
            { bank: "BCA", norek: "8780524589", nama: "WD BARU BCA G49 / Illham Alamsyah" },
            { bank: "BCA", norek: "7680844512", nama: "WD BARU BCA G50 / YULIANA" },
            { bank: "BCA", norek: "7680843931", nama: "WD BARU BCA G51 / EKARIANSYAH HIDAYAT" },
            { bank: "BCA", norek: "0010828023", nama: "WD BARU BCA G52 / LESMANA" },
            { bank: "BCA", norek: "5411663737", nama: "WD BARU BCA G53 / LIF IFADILAH" },
            { bank: "BCA", norek: "7131809968", nama: "WD BARU BCA G55 / ROSITA" },
            { bank: "BCA", norek: "7560501441", nama: "WD BARU BCA G56 / WARNIAH" },
            { bank: "BCA", norek: "3420783166", nama: "WD BARU BCA G57 / RAMA SETIADI" },
            { bank: "BCA", norek: "4160830366", nama: "WD BARU BCA G58 / FITRI NURJANAH" },
            { bank: "BCA", norek: "2453716031", nama: "WD BARU BCA G59 / RIFAL HERIANA" },
            { bank: "BCA", norek: "1790403432", nama: "WD BARU BCA G60 / MUHAMAT ARDIANSYAH" },
            { bank: "BCA", norek: "1751292550", nama: "WD BARU BCA G61 / Mega Alas Tina Wati" },
            { bank: "BCA", norek: "1751291723", nama: "WD BARU BCA G62 / RIATNO" },
            { bank: "BCA", norek: "8288140182", nama: "WD BARU BCA G63 / MUHAMMAD AWALLUDIN AKMAL" },
            { bank: "BCA", norek: "7006734170", nama: "WD BARU BCA G64 / SRI NING MULIANI" },
            { bank: "MANDIRI", norek: "1190011421540", nama: "WD MANDIRI G2 / DAVINA RAMADANI" },
            { bank: "MANDIRI", norek: "1150010874842", nama: "WD MANDIRI G3 / Rifal Afrian" },
            { bank: "MANDIRI", norek: "1150011255686", nama: "WD MANDIRI G4 / SURYANTO" },
            { bank: "MANDIRI", norek: "1630014077211", nama: "WD MANDIRI G5 / TBMULYANA" },
            { bank: "MANDIRI", norek: "1180014679384", nama: "WD MANDIRI G6 / Nur hayati" },
            { bank: "BRI", norek: "121001003000530", nama: "WD BRI G1 / INDRA PUTRA JAYA" },
            { bank: "BRI", norek: "036801079333503", nama: "WD BRI G2 / I Wayan Wardana" },
            { bank: "BRI", norek: "086301004767507", nama: "WD BRI G3 / CHINTYA CIKAL NURSAID" },
            { bank: "BRI", norek: "385401005401504", nama: "WD BRI G4 / Febri Nurfitri Ramadhani" },
            { bank: "BRI", norek: "529601007842508", nama: "WD BRI G5 / NATALDO K.P,GULO" },
            { bank: "BRI", norek: "040401020446531", nama: "WD BRI G7 / MANGARA JOYAKHIN SIMANJUNTAK" },
            { bank: "BRI", norek: "133301010153508", nama: "WD BRI G8 / RIO EL FAHMIE LIZAM" },
            { bank: "BRI", norek: "040401067487506", nama: "WD BRI G9 / CUT MEUTHIA RAHMADHINA" },
            { bank: "BRI", norek: "529601007841502", nama: "WD BRI G10 / GABRIEL IMMANUEL SIBAGARIANG" },
            { bank: "BRI", norek: "033601159160506", nama: "WD BRI G11 / ERDIO RAVA DZHWAN" },
            { bank: "BRI", norek: "529601007850501", nama: "WD BRI G12 / FELLY YOSAFAT SIHOMBING" },
            { bank: "BRI", norek: "529601007838509", nama: "WD BRI G13 / MICHAEL JUNIOR HUTAGAOL" },
            { bank: "BRI", norek: "040401068331504", nama: "WD BRI G14 / ERWIN HUTABARAT" },
            { bank: "BNI", norek: "1924606390", nama: "WD BNI / G2 Dede Hardiansyah" },
            { bank: "BNI", norek: "1924233315", nama: "WD BNI / G3 Ujang" },
            { bank: "BNI", norek: "1924651785", nama: "WD BNI / G4 Eka Sofiana" },
            { bank: "BNI", norek: "1951788626", nama: "WD BNI / G5 RISMAWATI" },
            { bank: "BNI", norek: "1958533545", nama: "WD BNI / G6 BAGAS ARIA TRISNA" },
            { bank: "BNI", norek: "1958554963", nama: "WD BNI / G7 VITO PRAMANA SAPUTRA" },
            { bank: "BNI", norek: "1958554384", nama: "WD BNI / G8 SURYA WIJAYA" },
            { bank: "BNI", norek: "1992948425", nama: "WD BNI / G9 SUNARYA" },
            { bank: "BNI", norek: "1992953999", nama: "WD BNI / G10 KEVIN MAULANA LUBIS" },
            { bank: "BNI", norek: "1992980672", nama: "WD BNI / G11 MEMES FIRA DWIYANA" },
            { bank: "CIMB", norek: "708197093600", nama: "WD CIMB G1 / CECAR SARAMBU KUSUMO SUNDUN" },
            { bank: "CIMB", norek: "708256271300", nama: "WD CIMB G2 / DWI GILANG RAMADHAN" },
            { bank: "CIMB", norek: "708355880900", nama: "WD CIMB G3 / Erni Kisdiana" },
            { bank: "CIMB", norek: "708465826600", nama: "WD CIMB G4 / FADILLA CHAIRUNNISA" },
            { bank: "DANAMON", norek: "3693534160", nama: "WD DANAMON G1 / QOUBUS AKBAR ZAHRAN" },
            { bank: "DANAMON", norek: "903693140786", nama: "WD DANAMON G2 / EKA YUNI PERTIWI" },
            { bank: "MAYBANK", norek: "8755979133", nama: "WD MAYBANK G1 / Siti Nurlaila" },
            { bank: "BCA", norek: "6560357913", nama: "WD BCA G1 / INDRA SEPTIAN" },
            { bank: "BCA", norek: "5850396029", nama: "WD BCA G2 / Lilis Ernawati" },
            { bank: "BCA", norek: "1980356741", nama: "WD BCA G3 / FARIS IMAM BUCHORI" },
            { bank: "BCA", norek: "5798022754", nama: "WD BCA G4 / Amelia Wati Wibisono" },
            { bank: "BCA", norek: "5798039592", nama: "WD BCA G5 / Bobi Saputra" },
            { bank: "BCA", norek: "5830388291", nama: "WD BCA G6 / TJONG ARIH / M RAMDANI" },
            { bank: "BCA", norek: "1082902672", nama: "WD BCA G7 / SHERLY" },
            { bank: "BCA", norek: "4080258629", nama: "WD BCA G9 / Ratmi B Warsad" },
            { bank: "BCA", norek: "1370574959", nama: "WD BCA G10 / Ali Nurdin" },
            { bank: "BCA", norek: "0031420040", nama: "WD BCA G11 / REZA ADRIANNI" },
            { bank: "BCA", norek: "2770738434", nama: "WD BCA G12 / NURSIAH" },
            { bank: "BRI", norek: "055601011614538", nama: "WD BRI G1 / Priyo Aryatno" },
            { bank: "BRI", norek: "007101112376500", nama: "WD BRI G2 / Ari Romayanti" },
            { bank: "CIMB", norek: "763776016100", nama: "WD CIMB G1 / ROSIDA" },
            { bank: "CIMB", norek: "763724724000", nama: "WD CIMB G2 / IKAL BUDIAWAN" },
            { bank: "DANAMON", norek: "3674201797", nama: "BANK WD DANAMON G1 / M ADRIL YANSAH" }
        ].map(node => ({...node, saldo: 0, lastSaldo: 0}));

        async function syncData() {
            log("Initializing Global Engine Sync...", "text-indigo-400");
            try {
                const res = await fetch(`${CSV_URL}&t=${Date.now()}`);
                const text = await res.text();
                Papa.parse(text, {
                    complete: (results) => processSync(results.data),
                    error: (err) => log("Parser Error: " + err, "text-red-500")
                });
            } catch (e) { log("Connection Error: " + e.message, "text-red-500"); }
        }

        function processSync(rows) {
            let total = 0;
            let activeNodes = 0;
            
            masterNodes.forEach(node => {
                node.lastSaldo = node.saldo;
                node.saldo = 0;
                
                const cleanName = node.nama.split('/')[0].trim().toUpperCase();
                const row = rows.find(r => 
                    r.some(cell => cell && cell.toString().toUpperCase().includes(cleanName))
                );

                if (row) {
                    let numbers = [];
                    row.forEach(cell => {
                        let val = cell.toString().replace(/[^\d]/g, '');
                        if (val.length >= 4 && val !== node.norek) {
                            numbers.push(parseInt(val));
                        }
                    });
                    node.saldo = numbers.length > 0 ? numbers[numbers.length - 1] : 0;
                }
                
                if(node.saldo > 0) activeNodes++;
                total += node.saldo;
            });

            render();
            animateValue("totalAll", total);
            document.getElementById('nodeStats').innerText = `${activeNodes} / ${masterNodes.length}`;
            log(`Sync Completed. Found ${activeNodes} active terminals.`, "text-emerald-500");
        }

        function render() {
            const table = document.getElementById('mainTable');
            const stats = document.getElementById('bankStats');
            table.innerHTML = '';
            stats.innerHTML = '';
            
            let bStats = {};
            
            masterNodes.forEach(node => {
                bStats[node.bank] = (bStats[node.bank] || 0) + 1;
                const isChanged = node.saldo !== node.lastSaldo;
                const hasBalance = node.saldo > 0;
                
                table.innerHTML += `
                    <tr class="${isChanged ? 'row-update' : ''} ${hasBalance ? 'active-glow bg-emerald-500/5' : ''} hover:bg-white/[0.03] transition-colors">
                        <td class="p-6">
                            <span class="text-[10px] font-black px-3 py-1.5 ${hasBalance ? 'bg-emerald-500/20 text-emerald-400' : 'bg-indigo-500/10 text-indigo-400'} rounded-lg border border-white/5 uppercase">
                                ${node.bank}
                            </span>
                        </td>
                        <td class="p-6">
                            <div class="flex flex-col">
                                <span class="text-sm font-bold ${hasBalance ? 'text-white' : 'text-slate-300'} uppercase">${node.nama}</span>
                                <button onclick="copyText('${node.norek}')" class="text-left text-[10px] mono text-slate-500 hover:text-indigo-400 transition-colors tracking-widest uppercase">
                                    <i class="far fa-copy mr-1"></i> ${node.norek}
                                </button>
                            </div>
                        </td>
                        <td class="p-6 text-right font-black mono text-xl ${hasBalance ? 'text-emerald-400' : 'text-slate-700'}">
                            ${formatIDR(node.saldo)}
                        </td>
                        <td class="p-6 text-center">
                            <div class="flex items-center justify-center gap-2">
                                <div class="w-2.5 h-2.5 rounded-full ${hasBalance ? 'bg-emerald-500 shadow-[0_0_12px_#10b981]' : 'bg-slate-800'}"></div>
                                <span class="text-[9px] font-bold ${hasBalance ? 'text-emerald-500' : 'text-slate-700'} uppercase">
                                    ${hasBalance ? 'Priority' : 'Idle'}
                                </span>
                            </div>
                        </td>
                    </tr>
                `;
            });

            Object.entries(bStats).sort((a,b) => b[1] - a[1]).forEach(([name, count]) => {
                const p = (count / masterNodes.length) * 100;
                stats.innerHTML += `
                    <div class="group">
                        <div class="flex justify-between text-[10px] font-bold text-slate-500 mb-1.5 uppercase group-hover:text-slate-300 transition-colors">
                            <span>${name}</span><span>${count} Units</span>
                        </div>
                        <div class="h-1.5 bg-white/5 rounded-full overflow-hidden">
                            <div class="h-full bg-gradient-to-r from-indigo-600 to-blue-400 transition-all duration-1000" style="width: ${p}%"></div>
                        </div>
                    </div>
                `;
            });
        }

        function animateValue(id, end) {
            const obj = document.getElementById(id);
            const current = parseInt(obj.innerText.replace(/[^\d]/g, '')) || 0;
            const range = end - current;
            const duration = 1000;
            let start = null;

            function step(timestamp) {
                if (!start) start = timestamp;
                const progress = Math.min((timestamp - start) / duration, 1);
                obj.innerText = formatIDR(Math.floor(current + (range * progress)));
                if (progress < 1) window.requestAnimationFrame(step);
            }
            window.requestAnimationFrame(step);
        }

        function formatIDR(v) { return "Rp " + new Intl.NumberFormat('id-ID').format(v); }
        
        function log(m, colorClass = "text-slate-400") {
            const l = document.getElementById('logs');
            const time = new Date().toLocaleTimeString('id-ID', { hour12: false });
            l.innerHTML = `
                <div class="flex gap-2 animate-in fade-in slide-in-from-left-2 duration-300">
                    <span class="text-indigo-500/50">[${time}]</span>
                    <span class="${colorClass}">${m}</span>
                </div>` + l.innerHTML;
            if(l.children.length > 50) l.lastElementChild.remove();
        }

        function copyText(text) {
            navigator.clipboard.writeText(text);
            log(`Copied Account: ${text}`, "text-indigo-300");
        }

        function filter() {
            const v = document.getElementById('search').value.toLowerCase();
            document.querySelectorAll('#mainTable tr').forEach(r => {
                r.style.display = r.innerText.toLowerCase().includes(v) ? '' : 'none';
            });
        }

        // Init
        syncData();
        setInterval(syncData, 30000); // Sinkronisasi setiap 30 detik
    </script>
</body>
</html>
