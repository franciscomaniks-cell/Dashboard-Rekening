<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>TVTOTO ULTRA v6.0 - FINAL STABLE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { background-color: #020617; color: white; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); }
        .row-update { animation: highlight 2s ease-out; }
        @keyframes highlight { 0% { background: rgba(52, 211, 153, 0.2); } 100% { background: transparent; } }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: #020617; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .sticky-head { position: sticky; top: 0; background: #1e293b; z-index: 20; }
    </style>
</head>
<body class="p-4">
<div class="max-w-7xl mx-auto">
    
    <div class="flex flex-col md:flex-row justify-between items-center mb-6 glass p-6 rounded-2xl shadow-2xl gap-4 border-l-4 border-l-indigo-500">
        <div class="flex items-center gap-4">
            <div class="h-14 w-14 bg-gradient-to-br from-indigo-600 to-blue-700 rounded-2xl flex items-center justify-center shadow-xl shadow-indigo-500/20">
                <span class="text-2xl font-black italic tracking-tighter">TV</span>
            </div>
            <div>
                <h1 class="text-2xl font-black tracking-tight text-white uppercase italic">TVTOTO <span class="text-indigo-400 not-italic font-bold text-xs tracking-[0.3em] ml-2">MONITOR v6.0</span></h1>
                <p id="status" class="text-[10px] text-slate-500 font-mono uppercase mt-1 tracking-widest italic">Menunggu Sinkronisasi...</p>
            </div>
        </div>
        <div class="text-center md:text-right bg-slate-900/80 p-4 rounded-2xl border border-white/5 min-w-[320px] shadow-inner">
            <p class="text-[10px] text-slate-400 uppercase font-bold tracking-[0.2em] mb-1">Total Saldo Seluruh Bank</p>
            <h2 id="totalAll" class="text-3xl font-black text-emerald-400 font-mono tracking-tighter italic">Rp 0</h2>
        </div>
    </div>

    <div class="mb-6 flex flex-col md:flex-row gap-4">
        <div class="relative flex-1">
            <input type="text" id="search" placeholder="Cari Nama atau Nomor Rekening..." class="w-full bg-slate-900/50 border border-slate-700 p-4 rounded-2xl outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all text-sm shadow-lg">
        </div>
        <button id="refreshBtn" class="bg-indigo-600 hover:bg-indigo-500 active:scale-95 px-10 py-4 rounded-2xl font-black transition-all shadow-xl shadow-indigo-600/20 uppercase tracking-widest text-xs">
            REFRESH DATA
        </button>
    </div>

    <div class="glass rounded-3xl overflow-hidden border border-white/5 shadow-2xl">
        <div class="overflow-x-auto max-h-[650px] custom-scroll overflow-y-auto">
            <table class="w-full text-left border-collapse">
                <thead class="sticky-head shadow-xl">
                    <tr class="text-slate-400 text-[10px] uppercase font-bold tracking-widest border-b border-white/5">
                        <th class="p-5">Bank</th>
                        <th class="p-5">Info Rekening</th>
                        <th class="p-5 text-right">Saldo Terdeteksi</th>
                    </tr>
                </thead>
                <tbody id="mainTable" class="divide-y divide-white/5">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
// DATA MASTER AKURAT (124 REKENING)
const masterData = [
    { bank: "OCBC", norek: "621810071939", nama: "Raisah Bt Rali", saldo: 0 },
    { bank: "OCBC", norek: "624810073756", nama: "Jerry Rand", saldo: 0 },
    { bank: "SINARMAS", norek: "59567365", nama: "Raisah Bt Rali", saldo: 0 },
    { bank: "SINAR MAS", norek: "18464268", nama: "TUTI SAHRIYATUN", saldo: 0 },
    { bank: "SINARMAS", norek: "59632086", nama: "Asha Intan Permatasari", saldo: 0 },
    { bank: "DANAMON", norek: "3690919737", nama: "Hendra", saldo: 0 },
    { bank: "DANAMON", norek: "903691375012", nama: "UMAS", saldo: 0 },
    { bank: "DANAMON", norek: "3692115276", nama: "HANI SITI WAHYUNI", saldo: 0 },
    { bank: "BCA", norek: "1940533356", nama: "Billy Tanjung Kurniawan", saldo: 0 },
    { bank: "BCA", norek: "5781176851", nama: "Idris Sardi", saldo: 0 },
    { bank: "BCA", norek: "663529428", nama: "Adellia Citra", saldo: 0 },
    { bank: "BCA", norek: "7120806232", nama: "Rahman Fauzan Oktora", saldo: 0 },
    { bank: "BNI", norek: "1926659556", nama: "Ujang Suparman", saldo: 0 },
    { bank: "BNI", norek: "1821381905", nama: "ALVIN NUARI", saldo: 0 },
    { bank: "BNI", norek: "1984533769", nama: "Irma Yunita", saldo: 0 },
    { bank: "MANDIRI", norek: "1060020111673", nama: "Fandy Ramadhan", saldo: 0 },
    { bank: "MANDIRI", norek: "1150010841072", nama: "Muhamad Ramdhan Saputra", saldo: 0 },
    { bank: "MANDIRI", norek: "1150010841973", nama: "Wahidin", saldo: 0 },
    { bank: "MANDIRI", norek: "1630011517151", nama: "M. Encep Juliana", saldo: 0 },
    { bank: "MANDIRI", norek: "1050021291152", nama: "Abdul Akbar", saldo: 0 },
    { bank: "MANDIRI", norek: "1560025221336", nama: "Dede", saldo: 0 },
    { bank: "MANDIRI", norek: "1190012025357", nama: "FATHAN FARISAN", saldo: 0 },
    { bank: "MANDIRI", norek: "1110024376150", nama: "Irwan firmansyah", saldo: 0 },
    { bank: "MANDIRI", norek: "1110024362895", nama: "Yoniko Samura Narazhaki", saldo: 0 },
    { bank: "MANDIRI", norek: "1150010412486", nama: "Nurlindawati", saldo: 0 },
    { bank: "BRI", norek: "224801006440509", nama: "Susanto", saldo: 0 },
    { bank: "BRI", norek: "370501002173501", nama: "Faizah", saldo: 0 },
    { bank: "BRI", norek: "384801022008500", nama: "Vito Radiansah", saldo: 0 },
    { bank: "BCA", norek: "7125821189", nama: "Ahmad rifaldi", saldo: 0 },
    { bank: "BCA", norek: "842477920", nama: "BENTAR PUTRA PRATAMA", saldo: 0 },
    { bank: "BRI", norek: "041801022619503", nama: "Ferdi alexander", saldo: 0 },
    { bank: "BCA", norek: "4931010845", nama: "Heni Parantina", saldo: 0 },
    { bank: "BCA", norek: "0955074161", nama: "Lia Kusmiati", saldo: 0 },
    { bank: "BCA", norek: "4931010870", nama: "Sanah", saldo: 0 },
    { bank: "BCA", norek: "4080275736", nama: "EKA SUSANTI", saldo: 0 },
    { bank: "DANAMON", norek: "903687401202", nama: "Kezia Victoria Halim", saldo: 0 },
    { bank: "DANAMON", norek: "3682785617", nama: "Marchellino Alfaro", saldo: 0 },
    { bank: "BCA", norek: "2770799271", nama: "HANIKA", saldo: 0 },
    { bank: "BCA", norek: "4770265431", nama: "RACHEL INEKE PUTRI", saldo: 0 },
    { bank: "BCA", norek: "7275566039", nama: "SITI HEFTIYANAH", saldo: 0 },
    { bank: "BCA", norek: "3120967893", nama: "Inzaghi", saldo: 0 },
    { bank: "BCA", norek: "0322713337", nama: "Gusnimar", saldo: 0 },
    { bank: "BCA", norek: "6313017261", nama: "MUHAMMAD ABIZAL", saldo: 0 },
    { bank: "BCA", norek: "2320743829", nama: "SURYA DITA RAHMATUL AKBAR", saldo: 0 },
    { bank: "BCA", norek: "2620246002", nama: "TERRA INGGIT HERMAWAN", saldo: 0 },
    { bank: "BCA", norek: "5320274798", nama: "ENTIK SUPARMAN", saldo: 0 },
    { bank: "BCA", norek: "5860564442", nama: "MUHAMAD RIZKY", saldo: 0 },
    { bank: "BCA", norek: "0031438801", nama: "KHESYA ALEYA PUTRI", saldo: 0 },
    { bank: "BCA", norek: "3110139623", nama: "M. DANI ABDUL MANAP", saldo: 0 },
    { bank: "BCA", norek: "0010824427", nama: "ROBBY KUSUMA", saldo: 0 },
    { bank: "BCA", norek: "0740187309", nama: "RIZKI APRIADI", saldo: 0 },
    { bank: "BCA", norek: "7680835416", nama: "MARTHEN JEVERSON DJAWE MONE", saldo: 0 },
    { bank: "BCA", norek: "1790386759", nama: "Suhaeriah", saldo: 0 },
    { bank: "BCA", norek: "1790387275", nama: "Iwan", saldo: 0 },
    { bank: "BCA", norek: "2290700895", nama: "AHMAD SYAUKI", saldo: 0 },
    { bank: "BCA", norek: "4670456922", nama: "RAFLY FADILLAH", saldo: 0 },
    { bank: "BCA", norek: "2453648117", nama: "WIKA ISMAWATII", saldo: 0 },
    { bank: "BCA", norek: "0020325941", nama: "GUSTIAN", saldo: 0 },
    { bank: "BCA", norek: "5781171892", nama: "APRILIANTO", saldo: 0 },
    { bank: "BCA", norek: "6087026304", nama: "Saeful Anwar", saldo: 0 },
    { bank: "BCA", norek: "4871057936", nama: "Irham Permana Solehudin", saldo: 0 },
    { bank: "BCA", norek: "4120398186", nama: "HAMDAN", saldo: 0 },
    { bank: "BCA", norek: "7655625119", nama: "IRWAN KURNIAWAN", saldo: 0 },
    { bank: "BCA", norek: "4120398526", nama: "ARVAN AVANDI", saldo: 0 },
    { bank: "BCA", norek: "5411607802", nama: "Muhaddad", saldo: 0 },
    { bank: "BCA", norek: "4871055585", nama: "Muhammad Noerchalik", saldo: 0 },
    { bank: "BCA", norek: "1610170869", nama: "Muhammad Khairul Ummam", saldo: 0 },
    { bank: "BCA", norek: "7030454558", nama: "SUGENG WIDODO", saldo: 0 },
    { bank: "BCA", norek: "6920300063", nama: "MISDA", saldo: 0 },
    { bank: "BCA", norek: "2453647561", nama: "ROHILAH", saldo: 0 },
    { bank: "BCA", norek: "4810368697", nama: "DAVIEN JOE WIJAYA", saldo: 0 },
    { bank: "BCA", norek: "5411606288", nama: "NURHADI", saldo: 0 },
    { bank: "BCA", norek: "5195214333", nama: "EFI REFLINI", saldo: 0 },
    { bank: "BCA", norek: "8011098258", nama: "RANI SYAFRINA", saldo: 0 },
    { bank: "BCA", norek: "6920300209", nama: "NURASIAH", saldo: 0 },
    { bank: "BCA", norek: "5885270244", nama: "DEVIN FERNANDO", saldo: 0 },
    { bank: "BCA", norek: "2530408348", nama: "AHMAD ALTHOF", saldo: 0 },
    { bank: "BCA", norek: "0690669722", nama: "Mafiyah", saldo: 0 },
    { bank: "BCA", norek: "0562522768", nama: "ALVIN SULHAN HADI", saldo: 0 },
    { bank: "BCA", norek: "6085042339", nama: "AKHMAD GHIFARI AKBAR", saldo: 0 },
    { bank: "BCA", norek: "8780524589", nama: "Illham Alamsyah", saldo: 0 },
    { bank: "BCA", norek: "7680844512", nama: "YULIANA", saldo: 0 },
    { bank: "BCA", norek: "7680843931", nama: "EKARIANSYAH HIDAYAT", saldo: 0 },
    { bank: "BCA", norek: "0010828023", nama: "LESMANA", saldo: 0 },
    { bank: "BCA", norek: "5411663737", nama: "LIF IFADILAH", saldo: 0 },
    { bank: "BCA", norek: "7131809968", nama: "ROSITA", saldo: 0 },
    { bank: "BCA", norek: "7560501441", nama: "WARNIAH", saldo: 0 },
    { bank: "BCA", norek: "3420783166", nama: "RAMA SETIADI", saldo: 0 },
    { bank: "BCA", norek: "4160830366", nama: "FITRI NURJANAH", saldo: 0 },
    { bank: "BCA", norek: "2453716031", nama: "RIFAL HERIANA", saldo: 0 },
    { bank: "BCA", norek: "1790403432", nama: "MUHAMAT ARDIANSYAH", saldo: 0 },
    { bank: "BCA", norek: "1751292550", nama: "Mega Alas Tina Wati", saldo: 0 },
    { bank: "BCA", norek: "1751291723", nama: "RIATNO", saldo: 0 },
    { bank: "BCA", norek: "8288140182", nama: "MUHAMMAD AWALLUDIN AKMAL", saldo: 0 },
    { bank: "BCA", norek: "7006734170", nama: "SRI NING MULIANI", saldo: 0 },
    { bank: "MANDIRI", norek: "1190011421540", nama: "DAVINA RAMADANI", saldo: 0 },
    { bank: "MANDIRI", norek: "1150010874842", nama: "Rifal Afrian", saldo: 0 },
    { bank: "MANDIRI", norek: "1150011255686", nama: "SURYANTO", saldo: 0 },
    { bank: "MANDIRI", norek: "1630014077211", nama: "TBMULYANA", saldo: 0 },
    { bank: "MANDIRI", norek: "1180014679384", nama: "Nur hayati", saldo: 0 },
    { bank: "BRI", norek: "121001003000530", nama: "INDRA PUTRA JAYA", saldo: 0 },
    { bank: "BRI", norek: "036801079333503", nama: "I Wayan Wardana", saldo: 0 },
    { bank: "BRI", norek: "086301004767507", nama: "CHINTYA CIKAL NURSAID", saldo: 0 },
    { bank: "BRI", norek: "385401005401504", nama: "Febri Nurfitri Ramadhani", saldo: 0 },
    { bank: "BRI", norek: "529601007842508", nama: "NATALDO K.P,GULO", saldo: 0 },
    { bank: "BRI", norek: "040401020446531", nama: "MANGARA JOYAKHIN SIMANJUNTAK", saldo: 0 },
    { bank: "BRI", norek: "133301010153508", nama: "RIO EL FAHMIE LIZAM", saldo: 0 },
    { bank: "BRI", norek: "040401067487506", nama: "CUT MEUTHIA RAHMADHINA", saldo: 0 },
    { bank: "BRI", norek: "529601007841502", nama: "GABRIEL IMMANUEL SIBAGARIANG", saldo: 0 },
    { bank: "BRI", norek: "033601159160506", nama: "ERDIO RAVA DZHWAN", saldo: 0 },
    { bank: "BRI", norek: "529601007850501", nama: "FELLY YOSAFAT SIHOMBING", saldo: 0 },
    { bank: "BRI", norek: "529601007838509", nama: "MICHAEL JUNIOR HUTAGAOL", saldo: 0 },
    { bank: "BRI", norek: "040401068331504", nama: "ERWIN HUTABARAT", saldo: 0 },
    { bank: "BNI", norek: "1924606390", nama: "Dede Hardiansyah", saldo: 0 },
    { bank: "BNI", norek: "1924233315", nama: "Ujang", saldo: 0 },
    { bank: "BNI", norek: "1924651785", nama: "Eka Sofiana", saldo: 0 },
    { bank: "BNI", norek: "1951788626", nama: "RISMAWATI", saldo: 0 },
    { bank: "BNI", norek: "1958533545", nama: "BAGAS ARIA TRISNA", saldo: 0 },
    { bank: "BNI", norek: "1958554963", nama: "VITO PRAMANA SAPUTRA", saldo: 0 },
    { bank: "BNI", norek: "1958554384", nama: "SURYA WIJAYA", saldo: 0 },
    { bank: "BNI", norek: "1992948425", nama: "SUNARYA", saldo: 0 },
    { bank: "BNI", norek: "1992953999", nama: "KEVIN MAULANA LUBIS", saldo: 0 },
    { bank: "BNI", norek: "1992980672", nama: "MEMES FIRA DWIYANA", saldo: 0 },
    { bank: "CIMB", norek: "708197093600", nama: "CECAR SARAMBU KUSUMO SUNDUN", saldo: 0 },
    { bank: "CIMB", norek: "708256271300", nama: "DWI GILANG RAMADHAN", saldo: 0 },
    { bank: "CIMB", norek: "708355880900", nama: "Erni Kisdiana", saldo: 0 },
    { bank: "CIMB", norek: "708465826600", nama: "FADILLA CHAIRUNNISA", saldo: 0 },
    { bank: "DANAMON", norek: "3693534160", nama: "QOUBUS AKBAR ZAHRAN", saldo: 0 },
    { bank: "DANAMON", norek: "903693140786", nama: "EKA YUNI PERTIWI", saldo: 0 },
    { bank: "MAYBANK", norek: "8755979133", nama: "Siti Nurlaila", saldo: 0 },
    { bank: "BCA", norek: "6560357913", nama: "INDRA SEPTIAN", saldo: 0 },
    { bank: "BCA", norek: "5850396029", nama: "Lilis Ernawati", saldo: 0 },
    { bank: "BCA", norek: "1980356741", nama: "FARIS IMAM BUCHORI", saldo: 0 },
    { bank: "BCA", norek: "5798022754", nama: "Amelia Wati Wibisono", saldo: 0 },
    { bank: "BCA", norek: "5798039592", nama: "Bobi Saputra", saldo: 0 },
    { bank: "BCA", norek: "5830388291", nama: "TJONG ARIH / M RAMDANI", saldo: 0 },
    { bank: "BCA", norek: "1082902672", nama: "SHERLY", saldo: 0 },
    { bank: "BCA", norek: "4080258629", nama: "Ratmi B Warsad", saldo: 0 },
    { bank: "BCA", norek: "1370574959", nama: "Ali Nurdin", saldo: 0 },
    { bank: "BCA", norek: "0031420040", nama: "REZA ADRIANNI", saldo: 0 },
    { bank: "BCA", norek: "2770738434", nama: "NURSIAH", saldo: 0 },
    { bank: "BRI", norek: "055601011614538", nama: "Priyo Aryatno", saldo: 0 },
    { bank: "BRI", norek: "007101112376500", nama: "Ari Romayanti", saldo: 0 },
    { bank: "CIMB", norek: "763776016100", nama: "ROSIDA", saldo: 0 },
    { bank: "CIMB", norek: "763724724000", nama: "IKAL BUDIAWAN", saldo: 0 },
    { bank: "DANAMON", norek: "3674201797", nama: "M ADRIL YANSAH", saldo: 0 }
];

const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSsnosH5qmA4ADdf2nPeM7k1JdZI-RDhgA4Y8GgSmB5Qs-9MCaaEdeykDzRGFjjcrjhotKKSyd5J_D0/pub?gid=1655913458&single=true&output=csv';

async function syncData() {
    const statusEl = document.getElementById('status');
    statusEl.innerText = "SINKRONISASI SEDANG BERJALAN...";
    try {
        const response = await fetch(CSV_URL + '&timestamp=' + new Date().getTime());
        const text = await response.text();
        Papa.parse(text, { 
            skipEmptyLines: true,
            complete: (results) => processMatrix(results.data) 
        });
    } catch (e) {
        statusEl.innerText = "KONEKSI GOOGLE SHEETS ERROR!";
    }
}

function processMatrix(rows) {
    let grandTotal = 0;
    
    masterData.forEach(acc => {
        const prevSaldo = acc.saldo;
        
        // Cari baris yang mengandung Nomor Rekening (Metode String Matching)
        const rowData = rows.find(r => r.join("").replace(/\s/g,'').includes(acc.norek));

        if (rowData) {
            let candidates = [];
            rowData.forEach(cell => {
                let numeric = cell.toString().replace(/[^0-9]/g, '');
                // Saldo biasanya minimal 1000 dan tidak sama dengan nomor rekening
                if (numeric.length >= 4 && numeric !== acc.norek) {
                    candidates.push(parseInt(numeric));
                }
            });
            // Logika: Saldo biasanya berada di paling kanan/akhir baris
            acc.saldo = candidates.length > 0 ? candidates[candidates.length - 1] : 0;
        }

        if (prevSaldo !== acc.saldo) acc.updated = true;
        grandTotal += acc.saldo;
    });

    renderUI();
    document.getElementById('totalAll').innerText = "Rp " + grandTotal.toLocaleString('id-ID');
    document.getElementById('status').innerText = "LIVE DATA OK: " + new Date().toLocaleTimeString();
}

function renderUI() {
    const tbody = document.getElementById('mainTable');
    tbody.innerHTML = '';
    
    masterData.forEach(acc => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-slate-800/40 transition duration-300 group cursor-default';
        if(acc.updated) {
            tr.classList.add('row-update');
            acc.updated = false;
        }
        
        tr.innerHTML = `
            <td class="p-5">
                <span class="px-3 py-1 bg-slate-800 text-indigo-400 text-[9px] font-black rounded-lg border border-slate-700 uppercase tracking-widest shadow-sm">
                    ${acc.bank}
                </span>
            </td>
            <td class="p-5">
                <div class="text-xs font-black text-slate-200 group-hover:text-indigo-300 transition-colors uppercase">${acc.nama}</div>
                <div class="text-[10px] text-slate-500 font-mono mt-1 tracking-tighter">${acc.norek}</div>
            </td>
            <td class="p-5 text-right font-mono font-bold ${acc.saldo > 0 ? 'text-emerald-400' : 'text-slate-700'}">
                <span class="text-[10px] mr-1 opacity-40">IDR</span>${acc.saldo.toLocaleString('id-ID')}
            </td>
        `;
        tbody.appendChild(tr);
    });
}

// Fitur Filter Cepat
document.getElementById('search').addEventListener('input', (e) => {
    const q = e.target.value.toUpperCase();
    document.querySelectorAll('#mainTable tr').forEach(r => {
        r.style.display = r.innerText.toUpperCase().includes(q) ? '' : 'none';
    });
});

document.getElementById('refreshBtn').addEventListener('click', syncData);

// Jalankan Otomatis
syncData();
setInterval(syncData, 20000); // Sinkronisasi tiap 20 detik
</script>
</body>
</html>
