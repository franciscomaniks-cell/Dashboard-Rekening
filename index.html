<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Rekening TVTOTO - Live</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body class="bg-gray-100 font-sans">

    <div class="flex min-h-screen">
        <div class="w-64 bg-indigo-900 text-white p-6 hidden md:block shrink-0 shadow-2xl">
            <h1 class="text-2xl font-bold mb-8 italic text-indigo-200">Dashboard TVTOTO</h1>
            <nav class="space-y-3">
                <a href="#" class="block py-2.5 px-4 rounded bg-indigo-800 transition shadow-inner"><i class="fas fa-sync-alt mr-2 animate-spin-slow"></i> Auto-Update ON</a>
                <div class="pt-4 border-t border-indigo-700 mt-4">
                    <p class="text-[10px] text-indigo-400 font-bold uppercase tracking-wider">Status Koneksi</p>
                    <div id="statusIndicator" class="flex items-center text-sm text-yellow-400 mt-1">
                        <span class="h-2 w-2 rounded-full bg-yellow-400 mr-2 animate-pulse"></span> Sinkronisasi...
                    </div>
                </div>
            </nav>
        </div>

        <div class="flex-1 p-8">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-extrabold text-gray-800 tracking-tight">Ringkasan Rekening</h2>
                    <p class="text-gray-500">Saldo diperbarui otomatis dari Google Sheets setiap 1 menit</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="ambilDataSaldo()" class="bg-white border border-indigo-600 text-indigo-600 px-4 py-2 rounded-lg hover:bg-indigo-50 font-bold transition shadow-sm">
                        <i class="fas fa-redo-alt mr-2"></i>Refresh Saldo
                    </button>
                    <button onclick="toggleModal()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 shadow-md font-bold transition">
                        <i class="fas fa-plus mr-2"></i>Tambah Rekening
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-2xl shadow-sm border-l-8 border-indigo-500 relative overflow-hidden">
                    <div class="relative z-10">
                        <p class="text-gray-400 text-xs uppercase font-black tracking-widest">Total Saldo Terpantau</p>
                        <p id="totalSaldo" class="text-3xl font-black text-gray-800 mt-1">Rp 0</p>
                    </div>
                    <i class="fas fa-wallet absolute right-[-10px] bottom-[-10px] text-gray-100 text-7xl"></i>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border-l-8 border-green-500 relative overflow-hidden">
                    <div class="relative z-10">
                        <p class="text-gray-400 text-xs uppercase font-black tracking-widest">Jumlah Rekening</p>
                        <p id="totalBank" class="text-3xl font-black text-gray-800 mt-1">0</p>
                    </div>
                    <i class="fas fa-university absolute right-[-10px] bottom-[-10px] text-gray-100 text-7xl"></i>
                </div>
            </div>

            <div class="mb-6 relative">
                <i class="fas fa-search absolute left-4 top-3.5 text-gray-400"></i>
                <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Cari Nama Akun, No. Rekening, atau Bank..." 
                class="w-full pl-12 pr-4 py-3 border-none rounded-xl shadow-sm focus:ring-2 focus:ring-indigo-500 transition">
            </div>

            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">
                <div class="overflow-x-auto max-h-[500px] overflow-y-auto">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-gray-50 text-gray-400 uppercase text-[10px] font-black sticky top-0 z-10">
                            <tr>
                                <th class="p-4 border-b">Nama Bank</th>
                                <th class="p-4 border-b">Informasi Akun</th>
                                <th class="p-4 border-b text-right">Saldo Terakhir</th>
                                <th class="p-4 border-b text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-gray-50 text-gray-700">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="modal" class="fixed inset-0 bg-indigo-900/50 hidden backdrop-blur-sm flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-2xl w-96 shadow-2xl transform transition-all scale-110">
            <h3 class="text-xl font-black mb-4 text-indigo-900 flex items-center italic">
                <i class="fas fa-plus-circle mr-2"></i> INPUT REKENING
            </h3>
            <div class="space-y-4">
                <input type="text" id="inputBank" placeholder="Nama Bank (BCA, BRI...)" class="w-full p-3 bg-gray-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500">
                <input type="text" id="inputNoRek" placeholder="Nomor Rekening" class="w-full p-3 bg-gray-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500">
                <input type="text" id="inputNama" placeholder="Nama Akun (Sesuai Spreadsheet)" class="w-full p-3 bg-gray-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500">
                <input type="number" id="inputSaldo" placeholder="Saldo Awal" class="w-full p-3 bg-gray-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500">
                <div class="flex space-x-3 pt-4">
                    <button onclick="simpanData()" class="flex-1 bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition shadow-lg">SIMPAN</button>
                    <button onclick="toggleModal()" class="flex-1 bg-gray-100 text-gray-500 py-3 rounded-xl font-bold hover:bg-gray-200 transition">BATAL</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // LINK CSV ANDA (PENTING: Ganti dengan link hasil Publish to Web anda)
        const sheetCSVUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSsnosH5qmA4ADdf2nPeM7k1JdZI-RDhgA4Y8GgSmB5Qs-9MCaaEdeykDzRGFjjcrjhotKKSyd5J_D0/pub?gid=1655913458&single=true&output=csv';

        // DATA MASTER (Daftar Rekening yang Anda berikan)
        let dataBank = [
            { bank: "OCBC", norek: "621810071939", nama: "Raisah Bt Rali", saldo: 0 },
            { bank: "OCBC", norek: "624810073756", nama: "Jerry Rand", saldo: 0 },
            { bank: "SINARMAS", norek: "0059567365", nama: "Raisah Bt Rali", saldo: 0 },
            { bank: "SINAR MAS", norek: "0018464268", nama: "TUTI SAHRIYATUN", saldo: 0 },
            { bank: "SINARMAS", norek: "0059632086", nama: "Asha Intan Permatasari", saldo: 0 },
            { bank: "DANAMON", norek: "3690919737", nama: "Hendra", saldo: 0 },
            { bank: "DANAMON", norek: "903691375012", nama: "UMAS", saldo: 0 },
            { bank: "DANAMON", norek: "3692115276", nama: "HANI SITI WAHYUNI", saldo: 0 },
            { bank: "BCA", norek: "1940533356", nama: "Billy Tanjung Kurniawan", saldo: 0 },
            { bank: "BCA", norek: "5781176851", nama: "Idris Sardi", saldo: 0 },
            { bank: "BCA", norek: "0663529428", nama: "Adellia Citra", saldo: 0 },
            { bank: "BCA", norek: "7120806232", nama: "Rahman Fauzan Oktora", saldo: 0 },
            { bank: "BNI", norek: "1926659556", nama: "Ujang Suparman", saldo: 0 },
            { bank: "BNI", norek: "1821381905", nama: "ALVIN NUARI", saldo: 0 },
            { bank: "BNI", norek: "1984533769", nama: "Irma Yunita", saldo: 0 },
            { bank: "MANDIRI", norek: "1060020111673", nama: "Fandy Ramadhan", saldo: 0 },
            { bank: "MANDIRI", norek: "1150010841072", nama: "Muhamad Ramdhan Saputra", saldo: 0 },
            { bank: "MANDIRI", norek: "1150010841973", nama: "Wahidin", saldo: 0 },
            { bank: "MANDIRI", norek: "1630011517151", nama: "M. Encep Juliana", saldo: 0 },
            { bank: "MANDIRI", norek: "1050021291152", nama: "Abdul Akbar", saldo: 0 },
            { bank: "MANDIRI", norek: "1560025221336", nama: "Dede", saldo: 0 },
            { bank: "MANDIRI", norek: "1190012025357", nama: "FATHAN FARISAN", saldo: 0 },
            { bank: "MANDIRI", norek: "1110024376150", nama: "Irwan firmansyah", saldo: 0 },
            { bank: "MANDIRI", norek: "1110024362895", nama: "Yoniko Samura Narazhaki", saldo: 0 },
            { bank: "MANDIRI", norek: "1150010412486", nama: "Nurlindawati", saldo: 0 },
            { bank: "BRI", norek: "224801006440509", nama: "Susanto", saldo: 0 },
            { bank: "BRI", norek: "370501002173501", nama: "Faizah", saldo: 0 },
            { bank: "BRI", norek: "384801022008500", nama: "Vito Radiansah", saldo: 0 },
            { bank: "BCA", norek: "7125821189", nama: "Ahmad rifaldi", saldo: 0 },
            { bank: "BCA", norek: "842477920", nama: "BENTAR PUTRA PRATAMA", saldo: 0 },
            { bank: "BRI", norek: "041801022619503", nama: "Ferdi alexander", saldo: 0 },
            { bank: "BCA", norek: "4931010845", nama: "Heni Parantina", saldo: 0 },
            { bank: "BCA", norek: "0955074161", nama: "Lia Kusmiati", saldo: 0 },
            { bank: "BCA", norek: "4931010870", nama: "Sanah", saldo: 0 },
            { bank: "BCA", norek: "4080275736", nama: "EKA SUSANTI", saldo: 0 },
            { bank: "DANAMON", norek: "903687401202", nama: "Kezia Victoria Halim", saldo: 0 },
            { bank: "DANAMON", norek: "3682785617", nama: "Marchellino Alfaro", saldo: 0 },
            { bank: "BCA", norek: "2770799271", nama: "WD BARU BCA G1 / HANIKA", saldo: 0 },
            { bank: "BCA", norek: "4770265431", nama: "WD BARU BCA G2 / RACHEL INEKE PUTRI", saldo: 0 },
            { bank: "BCA", norek: "7275566039", nama: "WD BARU BCA G3 / SITI HEFTIYANAH", saldo: 0 },
            { bank: "BCA", norek: "3120967893", nama: "WD BARU BCA G4 / Inzaghi", saldo: 0 },
            { bank: "BCA", norek: "0322713337", nama: "WD BARU BCA G5 / Gusnimar", saldo: 0 },
            { bank: "BCA", norek: "6313017261", nama: "WD BARU BCA G7 / MUHAMMAD ABIZAL", saldo: 0 },
            { bank: "BCA", norek: "2320743829", nama: "WD BARU BCA G8 / SURYA DITA RAHMATUL AKBAR", saldo: 0 },
            { bank: "BCA", norek: "2620246002", nama: "WD BARU BCA G10 / TERRA INGGIT HERMAWAN", saldo: 0 },
            { bank: "BCA", norek: "5320274798", nama: "WD BARU BCA G12 / ENTIK SUPARMAN", saldo: 0 },
            { bank: "BCA", norek: "5860564442", nama: "WD BARU BCA G13 / MUHAMAD RIZKY", saldo: 0 },
            { bank: "BCA", norek: "0031438801", nama: "WD BARU BCA G14 / KHESYA ALEYA PUTRI", saldo: 0 },
            { bank: "BCA", norek: "3110139623", nama: "WD BARU BCA G15 / M. DANI ABDUL MANAP", saldo: 0 },
            { bank: "BCA", norek: "0010824427", nama: "WD BARU BCA G16 / ROBBY KUSUMA", saldo: 0 },
            { bank: "BCA", norek: "0740187309", nama: "WD BARU BCA G17 / RIZKI APRIADI", saldo: 0 },
            { bank: "BCA", norek: "7680835416", nama: "WD BARU BCA G18 / MARTHEN JEVERSON DJAWE MONE", saldo: 0 },
            { bank: "BCA", norek: "1790386759", nama: "WD BARU BCA G20 / Suhaeriah", saldo: 0 },
            { bank: "BCA", norek: "1790387275", nama: "WD BARU BCA G21 / Iwan", saldo: 0 },
            { bank: "BCA", norek: "2290700895", nama: "WD BARU BCA G22 / AHMAD SYAUKI", saldo: 0 },
            { bank: "BCA", norek: "4670456922", nama: "WD BARU BCA G23 / RAFLY FADILLAH", saldo: 0 },
            { bank: "BCA", norek: "2453648117", nama: "WD BARU BCA G24 / WIKA ISMAWATII", saldo: 0 },
            { bank: "BCA", norek: "0020325941", nama: "WD BARU BCA G25 / GUSTIAN", saldo: 0 },
            { bank: "BCA", norek: "5781171892", nama: "WD BARU BCA G26 / APRILIANTO", saldo: 0 },
            { bank: "BCA", norek: "6087026304", nama: "WD BARU BCA G27 / Saeful Anwar", saldo: 0 },
            { bank: "BCA", norek: "4871057936", nama: "WD BARU BCA G28 / Irham Permana Solehudin", saldo: 0 },
            { bank: "BCA", norek: "4120398186", nama: "WD BARU BCA G29 / HAMDAN", saldo: 0 },
            { bank: "BCA", norek: "7655625119", nama: "WD BARU BCA G30 / IRWAN KURNIAWAN", saldo: 0 },
            { bank: "BCA", norek: "4120398526", nama: "WD BARU BCA G31 / ARVAN AVANDI", saldo: 0 },
            { bank: "BCA", norek: "5411607802", nama: "WD BARU BCA G32 / Muhaddad", saldo: 0 },
            { bank: "BCA", norek: "4871055585", nama: "WD BARU BCA G33 / Muhammad Noerchalik", saldo: 0 },
            { bank: "BCA", norek: "1610170869", nama: "WD BARU BCA G34 / Muhammad Khairul Ummam", saldo: 0 },
            { bank: "BCA", norek: "7030454558", nama: "WD BARU BCA G36 / SUGENG WIDODO", saldo: 0 },
            { bank: "BCA", norek: "6920300063", nama: "WD BARU BCA G37 / MISDA", saldo: 0 },
            { bank: "BCA", norek: "2453647561", nama: "WD BARU BCA G38 / ROHILAH", saldo: 0 },
            { bank: "BCA", norek: "4810368697", nama: "WD BARU BCA G39 / DAVIEN JOE WIJAYA", saldo: 0 },
            { bank: "BCA", norek: "5411606288", nama: "WD BARU BCA G40 / NURHADI", saldo: 0 },
            { bank: "BCA", norek: "5195214333", nama: "WD BARU BCA G41 / EFI REFLINI", saldo: 0 },
            { bank: "BCA", norek: "8011098258", nama: "WD BARU BCA G42 / RANI SYAFRINA", saldo: 0 },
            { bank: "BCA", norek: "6920300209", nama: "WD BARU BCA G43 / NURASIAH", saldo: 0 },
            { bank: "BCA", norek: "5885270244", nama: "WD BARU BCA G44 / DEVIN FERNANDO", saldo: 0 },
            { bank: "BCA", norek: "2530408348", nama: "WD BARU BCA G45 / AHMAD ALTHOF", saldo: 0 },
            { bank: "BCA", norek: "0690669722", nama: "WD BARU BCA G46 / Mafiyah", saldo: 0 },
            { bank: "BCA", norek: "0562522768", nama: "WD BARU BCA G47 / ALVIN SULHAN HADI", saldo: 0 },
            { bank: "BCA", norek: "6085042339", nama: "WD BARU BCA G48 / AKHMAD GHIFARI AKBAR", saldo: 0 },
            { bank: "BCA", norek: "8780524589", nama: "WD BARU BCA G49 / Illham Alamsyah", saldo: 0 },
            { bank: "BCA", norek: "7680844512", nama: "WD BARU BCA G50 / YULIANA", saldo: 0 },
            { bank: "BCA", norek: "7680843931", nama: "WD BARU BCA G51 / EKARIANSYAH HIDAYAT", saldo: 0 },
            { bank: "BCA", norek: "0010828023", nama: "WD BARU BCA G52 / LESMANA", saldo: 0 },
            { bank: "BCA", norek: "5411663737", nama: "WD BARU BCA G53 / LIF IFADILAH", saldo: 0 },
            { bank: "BCA", norek: "7131809968", nama: "WD BARU BCA G55 / ROSITA", saldo: 0 },
            { bank: "BCA", norek: "7560501441", nama: "WD BARU BCA G56 / WARNIAH", saldo: 0 },
            { bank: "BCA", norek: "3420783166", nama: "WD BARU BCA G57 / RAMA SETIADI", saldo: 0 },
            { bank: "BCA", norek: "4160830366", nama: "WD BARU BCA G58 / FITRI NURJANAH", saldo: 0 },
            { bank: "BCA", norek: "2453716031", nama: "WD BARU BCA G59 / RIFAL HERIANA", saldo: 0 },
            { bank: "BCA", norek: "1790403432", nama: "WD BARU BCA G60 / MUHAMAT ARDIANSYAH", saldo: 0 },
            { bank: "BCA", norek: "1751292550", nama: "WD BARU BCA G61 / Mega Alas Tina Wati", saldo: 0 },
            { bank: "BCA", norek: "1751291723", nama: "WD BARU BCA G62 / RIATNO", saldo: 0 },
            { bank: "BCA", norek: "8288140182", nama: "WD BARU BCA G63 / MUHAMMAD AWALLUDIN AKMAL", saldo: 0 },
            { bank: "BCA", norek: "7006734170", nama: "WD BARU BCA G64 / SRI NING MULIANI", saldo: 0 },
            { bank: "MANDIRI", norek: "1190011421540", nama: "WD MANDIRI G2 / DAVINA RAMADANI", saldo: 0 },
            { bank: "MANDIRI", norek: "1150010874842", nama: "WD MANDIRI G3 / Rifal Afrian", saldo: 0 },
            { bank: "MANDIRI", norek: "1150011255686", nama: "WD MANDIRI G4 / SURYANTO", saldo: 0 },
            { bank: "MANDIRI", norek: "1630014077211", nama: "WD MANDIRI G5 / TBMULYANA", saldo: 0 },
            { bank: "MANDIRI", norek: "1180014679384", nama: "WD MANDIRI G6 / Nur hayati", saldo: 0 },
            { bank: "BRI", norek: "121001003000530", nama: "WD BRI G1 / INDRA PUTRA JAYA", saldo: 0 },
            { bank: "BRI", norek: "036801079333503", nama: "WD BRI G2 / I Wayan Wardana", saldo: 0 },
            { bank: "BRI", norek: "086301004767507", nama: "WD BRI G3 / CHINTYA CIKAL NURSAID", saldo: 0 },
            { bank: "BRI", norek: "385401005401504", nama: "WD BRI G4 / Febri Nurfitri Ramadhani", saldo: 0 },
            { bank: "BRI", norek: "529601007842508", nama: "WD BRI G5 / NATALDO K.P, GULO", saldo: 0 },
            { bank: "BRI", norek: "040401020446531", nama: "WD BRI G7 / MANGARA JOYAKHIN SIMANJUNTAK", saldo: 0 },
            { bank: "BRI", norek: "133301010153508", nama: "WD BRI G8 / RIO EL FAHMIE LIZAM", saldo: 0 },
            { bank: "BRI", norek: "040401067487506", nama: "WD BRI G9 / CUT MEUTHIA RAHMADHINA", saldo: 0 },
            { bank: "BRI", norek: "529601007841502", nama: "WD BRI G10 / GABRIEL IMMANUEL SIBAGARIAN", saldo: 0 },
            { bank: "BRI", norek: "033601159160506", nama: "WD BRI G11 / ERDIO RAVA DZHWAN", saldo: 0 },
            { bank: "BRI", norek: "529601007850501", nama: "WD BRI G12 / FELLY YOSAFAT SIHOMBING", saldo: 0 },
            { bank: "BRI", norek: "529601007838509", nama: "WD BRI G13 / MICHAEL JUNIOR HUTAGAOL", saldo: 0 },
            { bank: "BRI", norek: "040401068331504", nama: "WD BRI G14 / ERWIN HUTABARAT", saldo: 0 },
            { bank: "BNI", norek: "1924606390", nama: "WD BNI / G2 Dede Hardiansyah", saldo: 0 },
            { bank: "BNI", norek: "1924233315", nama: "WD BNI / G3 Ujang", saldo: 0 },
            { bank: "BNI", norek: "1924651785", nama: "WD BNI / G4 Eka Sofiana", saldo: 0 },
            { bank: "BNI", norek: "1951788626", nama: "WD BNI / G5 RISMAWATI", saldo: 0 },
            { bank: "BNI", norek: "1958533545", nama: "WD BNI / G6 BAGAS ARIA TRISNA", saldo: 0 },
            { bank: "BNI", norek: "1958554963", nama: "WD BNI / G7 VITO PRAMANA SAPUTRA", saldo: 0 },
            { bank: "BNI", norek: "1958554384", nama: "WD BNI / G8 SURYA WIJAYA", saldo: 0 },
            { bank: "BNI", norek: "1992948425", nama: "WD BNI / G9 SUNARYA", saldo: 0 },
            { bank: "BNI", norek: "1992953999", nama: "WD BNI / G10 KEVIN MAULANA LUBIS", saldo: 0 },
            { bank: "BNI", norek: "1992980672", nama: "WD BNI / G11 MEMES FIRA DWIYANA", saldo: 0 },
            { bank: "CIMB", norek: "708197093600", nama: "WD CIMB G1 / CECAR SARAMBU KUSUMO SUNDUN", saldo: 0 },
            { bank: "CIMB", norek: "708256271300", nama: "WD CIMB G2 / DWI GILANG RAMADHAN", saldo: 0 },
            { bank: "CIMB", norek: "708355880900", nama: "WD CIMB G3 / Erni Kisdiana", saldo: 0 },
            { bank: "CIMB", norek: "708465826600", nama: "WD CIMB G4 / FADILLA CHAIRUNNISA", saldo: 0 },
            { bank: "DANAMON", norek: "3693534160", nama: "WD DANAMON G1 / QOUBUS AKBAR ZAHRAN", saldo: 0 },
            { bank: "DANAMON", norek: "903693140786", nama: "WD DANAMON G2 / EKA YUNI PERTIWI", saldo: 0 },
            { bank: "MAYBANK", norek: "8755979133", nama: "WD MAYBANK G1 / Siti Nurlaila", saldo: 0 }
        ];

        // --- FUNGSI UTAMA (SINKRONISASI SALDO) ---
        async function ambilDataSaldo() {
            updateStatusIndicator("loading");
            try {
                const response = await fetch(sheetCSVUrl);
                const dataText = await response.text();
                
                Papa.parse(dataText, {
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        cocokkanData(results.data);
                        updateStatusIndicator("online");
                    }
                });
            } catch (err) {
                updateStatusIndicator("offline");
                console.error("Gagal sinkronisasi");
            }
        }

        function cocokkanData(sheetData) {
            dataBank.forEach(bankItem => {
                // Cari di baris manapun di sheet yang namanya mirip dengan nama di daftar kita
                const barisCocok = sheetData.find(row => {
                    const namaDiSheet = Object.values(row).join(" ").toUpperCase();
                    return namaDiSheet.includes(bankItem.nama.toUpperCase());
                });

                if (barisCocok) {
                    // Cari angka saldo di baris tersebut
                    const saldoRaw = Object.values(barisCocok).find(val => /[0-9]{4,}/.test(val));
                    if (saldoRaw) {
                        bankItem.saldo = parseInt(saldoRaw.replace(/[^0-9]/g, '')) || 0;
                    }
                }
            });
            renderTable();
        }

        // --- FUNGSI UI ---
        function formatRupiah(angka) {
            return "Rp " + new Intl.NumberFormat('id-ID').format(angka);
        }

        function renderTable(dataToRender = dataBank) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            let total = 0;

            dataToRender.forEach((item, index) => {
                total += parseInt(item.saldo);
                tableBody.innerHTML += `
                    <tr class="hover:bg-indigo-50/50 transition border-b group">
                        <td class="p-4">
                            <span class="bg-indigo-100 text-indigo-700 text-[10px] font-black px-2 py-1 rounded-md uppercase tracking-tighter">${item.bank}</span>
                        </td>
                        <td class="p-4">
                            <p class="text-[11px] text-gray-400 font-mono tracking-tighter">${item.norek}</p>
                            <p class="font-bold text-gray-800 uppercase text-xs">${item.nama}</p>
                        </td>
                        <td class="p-4 text-right">
                            <p class="font-black ${item.saldo > 0 ? 'text-green-600' : 'text-gray-300'} text-sm">${formatRupiah(item.saldo)}</p>
                        </td>
                        <td class="p-4 text-center">
                            <button onclick="hapusData(${index})" class="text-gray-300 hover:text-red-500 transition transform hover:scale-125">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });

            document.getElementById('totalSaldo').innerText = formatRupiah(total);
            document.getElementById('totalBank').innerText = dataToRender.length;
        }

        function searchTable() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const filtered = dataBank.filter(item => 
                item.nama.toLowerCase().includes(input) || 
                item.norek.includes(input) || 
                item.bank.toLowerCase().includes(input)
            );
            renderTable(filtered);
        }

        function updateStatusIndicator(state) {
            const indicator = document.getElementById('statusIndicator');
            if(state === "online") {
                indicator.innerHTML = '<span class="h-2 w-2 rounded-full bg-green-500 mr-2"></span> Terhubung (Live)';
                indicator.className = "flex items-center text-sm text-green-400 mt-1 font-bold";
            } else if(state === "loading") {
                indicator.innerHTML = '<span class="h-2 w-2 rounded-full bg-yellow-400 mr-2 animate-pulse"></span> Sinkronisasi...';
                indicator.className = "flex items-center text-sm text-yellow-400 mt-1";
            } else {
                indicator.innerHTML = '<span class="h-2 w-2 rounded-full bg-red-500 mr-2"></span> Offline / Error';
                indicator.className = "flex items-center text-sm text-red-400 mt-1";
            }
        }

        // --- FUNGSI MODAL ---
        function toggleModal() { document.getElementById('modal').classList.toggle('hidden'); }

        function simpanData() {
            const bank = document.getElementById('inputBank').value;
            const norek = document.getElementById('inputNoRek').value;
            const nama = document.getElementById('inputNama').value;
            const saldo = document.getElementById('inputSaldo').value || 0;

            if(bank && norek && nama) {
                dataBank.unshift({ bank, norek, nama, saldo: parseInt(saldo) });
                renderTable();
                toggleModal();
                document.querySelectorAll('input').forEach(i => i.value = '');
            } else {
                alert("Lengkapi data!");
            }
        }

        function hapusData(index) {
            if(confirm('Hapus data ini?')) {
                dataBank.splice(index, 1);
                renderTable();
            }
        }

        // JALANKAN PERTAMA KALI
        renderTable();
        ambilDataSaldo();
        
        // Refresh saldo otomatis tiap 60 detik
        setInterval(ambilDataSaldo, 60000);

    </script>
    <style>
        .animate-spin-slow { animation: spin 3s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #4f46e5; border-radius: 10px; }
    </style>
</body>
</html>

